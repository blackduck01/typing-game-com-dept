<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ğŸ† 2025 ì–´ì›Œì¦ˆ ê²°ê³¼ ë°œí‘œ ğŸ†</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;500;700;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        /* ğŸ¨ ë°°ê²½: íˆ¬í‘œ í˜ì´ì§€ì™€ í†µì¼ê° ìˆëŠ” ë”¥ ë„¤ì´ë¹„ */
        body {
            background: linear-gradient(135deg, #141e30, #243b55);
            margin: 0; padding: 20px 10px;
            color: #fff;
            font-family: 'Noto Sans KR', sans-serif;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .snowflake { position: fixed; top: -10px; color: rgba(255, 255, 255, 0.3); font-size: 1em; z-index: 0; pointer-events: none; animation: fall linear infinite; }
        @keyframes fall { to { transform: translateY(110vh); } }

        .container { max-width: 800px; margin: 0 auto; text-align: center; position: relative; z-index: 10; padding-bottom: 60px; }

        /* ğŸ¤« ë¹„ë°€ ë²„íŠ¼ì´ ìˆ¨ê²¨ì§„ íƒ€ì´í‹€ */
        h1 {
            font-size: 1.8rem; color: #FFD700; margin: 20px 0 10px 0;
            font-weight: 700; text-shadow: 0 2px 10px rgba(0,0,0,0.5);
            user-select: none; /* ë“œë˜ê·¸ ë°©ì§€ */
        }
        h1 span { cursor: pointer; } /* í´ë¦­ ê°€ëŠ¥ í‘œì‹œ */
        
        .subtitle { color: #ccc; font-size: 0.9rem; margin-bottom: 30px; font-weight: 300; }

        /* ğŸ“Š ì°¨íŠ¸ ì»¨í…Œì´ë„ˆ */
        .chart-box {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 15px;
            margin-bottom: 40px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 4px 20px rgba(0,0,0,0.4);
            height: 350px;
            position: relative;
        }

        /* ë¦¬ìŠ¤íŠ¸ ê·¸ë¦¬ë“œ */
        .review-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
        }

        /* ğŸ ê²°ê³¼ ì¹´ë“œ */
        .review-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            padding: 20px;
            text-align: left;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.2s;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        /* 1,2,3ë“± ê°•ì¡° */
        .review-card.rank-1 { border: 2px solid #FFD700; background: rgba(255, 215, 0, 0.1); }
        .review-card.rank-2 { border: 1px solid #C0C0C0; }
        .review-card.rank-3 { border: 1px solid #CD7F32; }

        .card-info { flex: 1; }
        .subject-name { font-size: 1.1rem; font-weight: 700; color: #fff; margin-bottom: 4px; }
        .prof-name { font-size: 0.8rem; color: #aaa; }
        
        .card-score { text-align: right; }
        .score-big { font-size: 1.5rem; font-weight: 900; color: #FFD700; }
        .score-sub { font-size: 0.8rem; color: #aaa; display: block; }

        .home-btn {
            display: inline-block; margin-top: 50px; padding: 12px 30px;
            border: 1px solid rgba(255,255,255,0.3); border-radius: 50px;
            color: #ccc; text-decoration: none; transition: all 0.3s;
        }
        .home-btn:hover { background: rgba(255,255,255,0.2); color: white; border-color: #fff; }

    </style>
</head>
<body>

    <div id="snow-container"></div>

    <div class="container">
        <h1><span id="secret-btn">2025</span> Lecture Awards ğŸ†</h1>
        <p class="subtitle">ëŒ€ë§ì˜ íˆ¬í‘œ ê²°ê³¼ë¥¼ ê³µê°œí•©ë‹ˆë‹¤!</p>

        <div class="chart-box">
            <canvas id="rankingChart"></canvas>
        </div>

        <div class="review-list" id="review-list"></div>

        <a href="index.html" class="home-btn">ğŸ  ë©”ì¸ìœ¼ë¡œ</a>
    </div>

    <script>
        // 1. ëˆˆì†¡ì´
        function createSnow() {
            const container = document.getElementById('snow-container');
            for(let i=0; i<30; i++){
                const snow = document.createElement('div');
                snow.className = 'snowflake';
                snow.innerHTML = 'â„';
                snow.style.left = Math.random() * 100 + 'vw';
                snow.style.animationDuration = Math.random() * 5 + 5 + 's'; 
                snow.style.opacity = Math.random() * 0.5 + 0.1;
                snow.style.fontSize = Math.random() * 8 + 4 + 'px';
                container.appendChild(snow);
            }
        }
        createSnow();

        // 2. ê°•ì˜ ë°ì´í„° (ê°€ë‚˜ë‹¤ìˆœ ì •ë ¬)
        const rawSubjects = [
            { id: 'c_prog', name: 'C í”„ë¡œê·¸ë˜ë°', prof: 'ê¸°ì´ˆë¶€í„° íƒ„íƒ„í•˜ê²Œ' },
            { id: 'data_st', name: 'ìë£Œêµ¬ì¡°', prof: 'ìŠ¤íƒ, í, íŠ¸ë¦¬...' },
            { id: 'os', name: 'ìš´ì˜ì²´ì œ', prof: 'ë°ë“œë½ê³¼ í”„ë¡œì„¸ìŠ¤' },
            { id: 'network', name: 'ì»´í“¨í„° ë„¤íŠ¸ì›Œí¬', prof: 'OSI 7ê³„ì¸µ' },
            { id: 'db', name: 'ë°ì´í„°ë² ì´ìŠ¤', prof: 'SQLì˜ ë§ˆë²•ì‚¬' },
            { id: 'algo', name: 'ì•Œê³ ë¦¬ì¦˜', prof: 'ì‹œê°„ë³µì¡ë„ì˜ ëŠª' },
            { id: 'com_arch', name: 'ì»´í“¨í„° êµ¬ì¡°', prof: 'CPUì˜ ë¹„ë°€' },
            { id: 'web_prog', name: 'ì›¹ í”„ë¡œê·¸ë˜ë°', prof: 'HTML/CSS/JS' }
        ];
        
        // â˜… ê°€ë‚˜ë‹¤ìˆœ ì •ë ¬ (íˆ¬í‘œ í˜ì´ì§€ë‘ ìˆœì„œ ë§ì¶¤)
        const subjects = rawSubjects.sort((a, b) => a.name.localeCompare(b.name));

        const listContainer = document.getElementById('review-list');
        let myChart = null;

        // 3. ì¹´ë“œ & ì°¨íŠ¸ ê·¸ë¦¬ê¸°
        function render() {
            listContainer.innerHTML = '';
            
            // ì ìˆ˜ ê³„ì‚° ë° ë­í‚¹ ì •ë ¬ìš© ë°°ì—´ ìƒì„±
            let rankingData = subjects.map(sub => {
                const savedData = JSON.parse(localStorage.getItem(`review_${sub.id}`)) || { total: 0, count: 0 };
                const avg = savedData.count === 0 ? 0 : (savedData.total / savedData.count).toFixed(2);
                return { ...sub, avg: parseFloat(avg), count: savedData.count };
            });

            // ì ìˆ˜ ë†’ì€ ìˆœìœ¼ë¡œ ì •ë ¬ (ë­í‚¹ ë§¤ê¸°ê¸°ìš©)
            rankingData.sort((a, b) => b.avg - a.avg);

            // í™”ë©´ ê·¸ë¦¬ê¸° (ì›ë˜ ê°€ë‚˜ë‹¤ìˆœì¸ subjects ìˆœì„œëŒ€ë¡œ ì¹´ë“œë¥¼ ê·¸ë¦´ì§€, ë­í‚¹ìˆœìœ¼ë¡œ ê·¸ë¦´ì§€ ì„ íƒ)
            // -> ì—¬ê¸°ì„  ê°€ë‚˜ë‹¤ìˆœìœ¼ë¡œ ê·¸ë¦¬ê³ , 1ë“± í‘œì‹œë¥¼ í•´ì£¼ëŠ” ê²Œ ë³´ê¸° ì¢‹ìŒ.
            
            // ë­í‚¹ ì •ë³´ë¥¼ Mapìœ¼ë¡œ ì €ì¥ (ID -> Rank)
            const rankMap = {};
            rankingData.forEach((item, index) => {
                rankMap[item.id] = index + 1; // 1ë“±ë¶€í„° ì‹œì‘
            });

            // ì¹´ë“œ ìƒì„± (ê°€ë‚˜ë‹¤ìˆœ ë°°ì¹˜)
            subjects.forEach(sub => {
                const savedData = JSON.parse(localStorage.getItem(`review_${sub.id}`)) || { total: 0, count: 0 };
                const avg = savedData.count === 0 ? 0 : (savedData.total / savedData.count).toFixed(1);
                const rank = rankMap[sub.id];

                let rankClass = '';
                let badge = '';
                if(rank === 1) { rankClass = 'rank-1'; badge = 'ğŸ¥‡ 1ìœ„'; }
                else if(rank === 2) { rankClass = 'rank-2'; badge = 'ğŸ¥ˆ 2ìœ„'; }
                else if(rank === 3) { rankClass = 'rank-3'; badge = 'ğŸ¥‰ 3ìœ„'; }

                const card = document.createElement('div');
                card.className = `review-card ${rankClass}`;
                card.innerHTML = `
                    <div class="card-info">
                        <div class="subject-name">${badge} ${sub.name}</div>
                        <div class="prof-name">${sub.prof}</div>
                    </div>
                    <div class="card-score">
                        <span class="score-big">â­ ${avg}</span>
                        <span class="score-sub">(${savedData.count}ëª…)</span>
                    </div>
                `;
                listContainer.appendChild(card);
            });

            updateChart();
        }

        // 4. ì°¨íŠ¸ ì—…ë°ì´íŠ¸ (Chart.js)
        function updateChart() {
            const ctx = document.getElementById('rankingChart').getContext('2d');
            
            // ê°€ë‚˜ë‹¤ìˆœ ë¼ë²¨ & ë°ì´í„° ì¤€ë¹„
            const labels = subjects.map(s => s.name);
            const dataPoints = subjects.map(s => {
                const d = JSON.parse(localStorage.getItem(`review_${s.id}`)) || { total: 0, count: 0 };
                return d.count === 0 ? 0 : (d.total / d.count).toFixed(2);
            });

            // ìƒ‰ìƒ (ì ìˆ˜ ë†’ìœ¼ë©´ ê³¨ë“œ)
            const bgColors = dataPoints.map(score => {
                if(score >= 4.5) return 'rgba(255, 215, 0, 0.8)';
                if(score >= 3.5) return 'rgba(46, 204, 113, 0.8)';
                return 'rgba(255, 99, 132, 0.8)';
            });

            if(myChart) myChart.destroy();

            myChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'í‰ê·  í‰ì ',
                        data: dataPoints,
                        backgroundColor: bgColors,
                        borderColor: 'rgba(255,255,255,0.3)',
                        borderWidth: 1,
                        borderRadius: 6
                    }]
                },
                options: {
                    indexAxis: 'y', // ê°€ë¡œ ë§‰ëŒ€
                    scales: {
                        x: { beginAtZero: true, max: 5, ticks: { color: '#aaa' }, grid: { color: 'rgba(255,255,255,0.05)' } },
                        y: { ticks: { color: '#fff', font: { size: 12 } }, grid: { display: false } }
                    },
                    plugins: { legend: { display: false } },
                    maintainAspectRatio: false,
                    responsive: true
                }
            });
        }

        // â˜…â˜…â˜… 5. ê´€ë¦¬ì ì‹œí¬ë¦¿ ëª¨ë“œ â˜…â˜…â˜…
        // "2025"ë¥¼ 5ë²ˆ í„°ì¹˜í•˜ë©´ ì‹¤í–‰
        let clickCount = 0;
        document.getElementById('secret-btn').addEventListener('click', () => {
            clickCount++;
            if (clickCount === 5) {
                clickCount = 0;
                // ê°€ë‚˜ë‹¤ìˆœ ë¦¬ìŠ¤íŠ¸ ë³´ì—¬ì£¼ê³  ì…ë ¥ ë°›ê¸°
                let msg = "ê´€ë¦¬ì ëª¨ë“œ (ì ìˆ˜ ì¡°ì‘)\n\n";
                subjects.forEach((s, i) => msg += `${i+1}. ${s.name}\n`);
                msg += "\nìˆ˜ì •í•  ë²ˆí˜¸ì™€ ì ìˆ˜ë¥¼ ì…ë ¥ (ì˜ˆ: 1,4.8)";
                
                const input = prompt(msg);
                if (input) {
                    const [idx, score] = input.split(',');
                    const subjectIndex = parseInt(idx) - 1;
                    const newScore = parseFloat(score);
                    
                    if (subjects[subjectIndex] && !isNaN(newScore)) {
                        const targetId = subjects[subjectIndex].id;
                        // 10ëª…ì´ íˆ¬í‘œí•œ ê²ƒìœ¼ë¡œ ê°€ì •í•˜ê³  ë°ì´í„° ì €ì¥
                        const fakeData = { total: newScore * 10, count: 10, comments: [] };
                        localStorage.setItem(`review_${targetId}`, JSON.stringify(fakeData));
                        alert(`${subjects[subjectIndex].name} â†’ ${newScore}ì  ì ìš© ì™„ë£Œ!`);
                        render(); // í™”ë©´ ê°±ì‹ 
                    } else {
                        alert("ì…ë ¥ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.");
                    }
                }
            }
        });

        render();
    </script>
</body>
</html>
